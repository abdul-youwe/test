name: Sync Staging to Main (Exclude JSON files)
on:
    push:
        branches:
            - staging

jobs:
    build:
        runs-on: ubuntu-latest
        steps:
            - name: checkout
              uses: actions/checkout@v4
            
            # Add step to remove JSON files before creating PR
            - name: Remove JSON files
              run: |
                  rm -f templates/**/*.json || true
                  rm -f config/**/*.json || true
                  rm -f locales/**/*.json || true
                  
            - name: merge
              uses: peter-evans/create-pull-request@v5
              with:
                  token: ${{ secrets.GITHUB_TOKEN }}
                  branch: staging-sync
                  base: main
                  title: 'Sync: Staging to Main (Excluding JSON files)'
                  body: 'Automated PR to sync staging to main, excluding JSON files from templates, config, and locales directories'
